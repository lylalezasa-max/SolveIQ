<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SolveIQ - Una mano al docente</title>
<link rel="stylesheet" href="pagina.css">
<style>
  .student-row input {
    margin-right: 5px;
    padding: 5px;
  }
  #preview-table {
    border-collapse: collapse;
    width: 100%;
    text-align: center;
  }
  #preview-table th, #preview-table td {
    border: 1px solid #ccc;
    padding: 6px;
  }
</style>
</head>
<body>

<header>
  <div class="header-left">
    <h1>SolveIQ</h1>
  </div>
  <div class="header-right">
    <button onclick="window.location.href='intento1.html'">Iniciar Sesi√≥n</button>
  </div>
</header>

<div class="stats">
  <div class="stat-card"><h2></h2><p>Tiempo Ahorrado</p></div>
  <div class="stat-card"><h2></h2><p>Ex√°menes Creados</p></div>
  <div class="stat-card"><h2></h2><p>Docentes activos</p></div>
</div>

<!-- Men√∫ de navegaci√≥n -->
<nav>
  <a class="active" onclick="showSection('planificaciones', this)">Planificaciones</a>
  <a onclick="showSection('examenes', this)">Ex√°menes</a>
  <a onclick="showSection('calificaciones', this)">Calificaciones</a>
</nav>

<!-- PLANIFICACIONES -->
<div id="planificaciones" class="main-container">
  <h2>Generador de Planificaciones</h2>
  <div class="form-container">
    <div class="form-section">
      <h3>Configuraci√≥n de la Planificaci√≥n</h3>
      <div class="form-group"><label>Materia</label><input type="text" placeholder="Ej. Matem√°ticas, Ciencias..."></div>
      <div class="form-group"><label>Grado</label>
        <select>
          <option>Seleccionar grado</option>
          <option>1¬∞ Primer ciclo</option>
          <option>2¬∞ Primer ciclo</option>
          <option>3¬∞ Primer ciclo</option>
          <option>4¬∞ Segundo ciclo</option>
          <option>5¬∞ Segundo ciclo</option>
          <option>6¬∞ Segundo ciclo</option>
          <option>7¬∞ Tercer ciclo</option>
          <option>8¬∞ Tercer ciclo</option>
          <option>9¬∞ Tercer ciclo</option>
          <option>1¬∞ Bachillerato</option>
          <option>2¬∞ Bachillerato</option>
        </select>
      </div>
      <div class="form-group"><label>Tema de la Semana</label><input type="text" placeholder="Ej. Fracciones, Sistema Solar..."></div>
      <div class="form-group"><label>Objetivos de Aprendizaje</label><input type="text" placeholder="Escribe los objetivos..."></div>
      <div class="form-group"><label>Duraci√≥n por Clase</label>
        <select>
          <option>Seleccionar duraci√≥n</option>
          <option>30 minutos</option>
          <option>45 minutos</option>
          <option>60 minutos</option>
          <option>90 minutos</option>
        </select>
      </div>
      <div class="form-group"><label>Plantilla</label>
        <select>
          <option>Seleccionar plantilla</option>
          <option>B√°sica</option>
          <option>Detallada</option>
        </select>
      </div>
      <button class="btn-primary">Generar Planificaci√≥n</button>
    </div>
  </div>
</div>

<!-- EX√ÅMENES -->
<div id="examenes" class="main-container" style="display:none;">
  <h2>Creador de Ex√°menes</h2>
  <div class="form-container">
    <div class="form-section">
      <h3>Configuraci√≥n del Examen</h3>
      <p style="color:#666; font-size:14px;">Configura los par√°metros b√°sicos de tu examen</p>
      <div class="form-group"><label>T√≠tulo del Examen *</label><input type="text" placeholder="ej. Evaluaci√≥n de Fracciones - Primer Parcial"></div>
      <div class="form-group"><label>Materia *</label><input type="text" placeholder="ej. Matem√°ticas"></div>
      <div class="form-group"><label>Grado *</label>
        <select>
          <option>Seleccionar grado</option>
          <option>1¬∞</option><option>2¬∞</option><option>3¬∞</option>
        </select>
      </div>
      <div class="form-group"><label>Duraci√≥n del Examen</label>
        <select>
          <option>Seleccionar duraci√≥n</option>
          <option>30 min</option><option>60 min</option><option>90 min</option>
        </select>
      </div>
      <div class="form-group"><label>Nivel de Dificultad</label>
        <select>
          <option>Seleccionar dificultad</option>
          <option>B√°sico</option><option>Intermedio</option><option>Avanzado</option>
        </select>
      </div>
      <div class="form-group"><label>Instrucciones</label><textarea placeholder="Instrucciones especiales para el examen..."></textarea></div>
      <button class="btn-primary">Generar Examen Autom√°tico</button>
    </div>
    <div class="form-section">
      <h3>Opciones de Generaci√≥n</h3>
      <p style="color:#666; font-size:14px;">Personaliza el tipo y cantidad de preguntas</p>
      <div class="option"><div><strong>Preguntas de Opci√≥n M√∫ltiple</strong><p style="margin:0;color:#666;">Preguntas con 4 opciones</p></div><span>6-8 preguntas</span></div>
      <div class="option"><div><strong>Preguntas Verdadero/Falso</strong><p style="margin:0;color:#666;">Preguntas de selecci√≥n binaria</p></div><span>4-6 preguntas</span></div>
      <div class="option"><span>Generaci√≥n Inteligente</span><label class="switch"><input type="checkbox"><span class="slider"></span></label></div>
      <div class="option"><span>Incluir Gr√°ficos</span><label class="switch"><input type="checkbox"><span class="slider"></span></label></div>
      <div class="option"><span>Barajar Preguntas</span><label class="switch"><input type="checkbox"><span class="slider"></span></label></div>
      <div class="hint-box"><strong>üí° Sugerencia IA</strong><p>Bas√°ndome en el tema seleccionado, recomiendo incluir preguntas pr√°cticas y ejemplos cotidianos para mejor comprensi√≥n.</p></div>
    </div>
  </div>
</div>

<!-- CALIFICACIONES -->
<div id="calificaciones" class="main-container" style="display:none;">
  <h2>Gesti√≥n de Calificaciones</h2>
  <div class="form-container">
    <!-- Panel Izquierdo -->
    <div class="form-section">
      <h3>Configurar Calificaciones</h3>
      <p style="color:#666; font-size:14px;">Configura los datos b√°sicos de tu planilla</p>

      <div class="form-group"><label>Nombre de la Instituci√≥n *</label><input type="text" id="institucion" oninput="updatePreview()"></div>
      <div class="form-group"><label>Nombre del Profesor *</label><input type="text" id="profesor" oninput="updatePreview()"></div>
      <div class="form-group"><label>Materia *</label><input type="text" id="materia" oninput="updatePreview()"></div>

      <div class="form-group">
        <label>Grado *</label>
        <select id="grado" onchange="updatePreview()">
          <option>Seleccionar grado</option>
          <option>1¬∞</option><option>2¬∞</option><option>3¬∞</option><option>4¬∞</option><option>5¬∞</option>
          <option>6¬∞</option><option>7¬∞</option><option>8¬∞</option><option>9¬∞</option>
          <option>1¬∞ Bachillerato</option><option>2¬∞ Bachillerato</option>
        </select>
      </div>

      <div class="form-group">
        <label>Secci√≥n</label>
        <select id="seccion" onchange="updatePreview()">
          <option>Seleccionar secci√≥n</option>
          <option>A</option><option>B</option><option>C</option><option>D</option><option>E</option>
        </select>
      </div>

      <div class="form-group"><label>Fecha</label><input type="date" id="fecha" oninput="updatePreview()"></div>
      <div class="form-group"><label>Cantidad de Notas</label><input type="number" id="cantidadNotas" min="1" max="10" value="5" oninput="updateHeaders()"></div>

      <button class="btn-primary" onclick="addStudent()">‚ûï Agregar Alumno</button>
      <hr style="margin:15px 0;">
      <div style="display:flex;gap:10px;">
        <button class="btn-primary" onclick="exportExcel()">üì• Exportar Excel</button>
        <button class="btn-primary" onclick="exportPDF()">üìÑ Exportar PDF</button>
      </div>
    </div>

    <!-- Panel Derecho (Inputs din√°micos) -->
    <div class="form-section" style="flex:2;">
      <h3>Notas de Alumnos</h3>
      <p style="color:#666; font-size:14px;">Completa los campos y observa la vista previa</p>
      <div id="students-container"></div>
    </div>
  </div>

  <!-- Vista previa en tiempo real -->
  <div style="margin-top:30px;" id="preview-section">
    <h3>Vista Previa</h3>
    <table id="preview-table" style="border-collapse:collapse;width:100%;text-align:left;" border="1">
      <thead id="preview-header"></thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<!-- LIBRER√çAS -->
<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
// === FUNCI√ìN PARA CAMBIAR SECCIONES ===
function showSection(sectionId, el) {
  document.getElementById('planificaciones').style.display = 'none';
  document.getElementById('examenes').style.display = 'none';
  document.getElementById('calificaciones').style.display = 'none';
  document.getElementById(sectionId).style.display = 'block';
  document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
  if (el) el.classList.add('active');
}

// === CALIFICACIONES ===
let students = [];
let cantidadNotas = 5;

function updateHeaders() {
  cantidadNotas = Math.max(1, Math.min(10, parseInt(document.getElementById('cantidadNotas').value)||1));

  const institucion=document.getElementById('institucion').value;
  const profesor=document.getElementById('profesor').value;
  const materia=document.getElementById('materia').value;
  const grado=document.getElementById('grado').value;
  const seccion=document.getElementById('seccion').value;
  const fecha=document.getElementById('fecha').value;

  // columnas reales = 1 alumno + cantidadNotas + 1 promedio
  const totalCols = 2 + cantidadNotas;

  const header=document.getElementById('preview-header');
  header.innerHTML=`
    <tr><th colspan="${totalCols}">Instituci√≥n: ${institucion}</th></tr>
    <tr><th colspan="${totalCols}">Docente: ${profesor}</th></tr>
    <tr><th colspan="${totalCols}">Materia: ${materia}</th></tr>
    <tr>
      <th colspan="${Math.ceil(totalCols/2)}">Grado: ${grado}</th>
      <th colspan="${Math.floor(totalCols/2)}">Secci√≥n: ${seccion} &nbsp;&nbsp; Fecha: ${fecha}</th>
    </tr>
    <tr>
      <th>Alumno</th>
      ${Array.from({length:cantidadNotas}).map((_,i)=>`<th>Nota ${i+1}</th>`).join('')}
      <th>Promedio</th>
    </tr>
  `;
  rebuildStudentInputs();
  updatePreview();
}

function rebuildStudentInputs() {
  const container = document.getElementById('students-container');
  container.innerHTML = '';
  students.forEach((stu,index)=>{
    if(stu.notas.length!==cantidadNotas){
      stu.notas.length=cantidadNotas;
      stu.notas.fill('');
    }
    const studentDiv = document.createElement('div');
    studentDiv.className='student-row';
    studentDiv.style.marginBottom='10px';
    studentDiv.innerHTML = `
      <input type="text" placeholder="Apellidos" value="${stu.apellidos||''}" 
        oninput="students[${index}].apellidos=this.value;updatePreview();" style="width:150px;">
      <input type="text" placeholder="Nombres" value="${stu.nombres||''}" 
        oninput="students[${index}].nombres=this.value;updatePreview();" style="width:150px;">
      ${Array.from({length:cantidadNotas}).map((_,i)=>`
        <input type="number" max="10" placeholder="Nota ${i+1}" value="${stu.notas[i]||''}" 
        oninput="updateStudentGrade(${index},${i},this.value)" style="width:70px;">
      `).join('')}
      <button onclick="removeStudent(${index})" style="margin-left:5px;color:red;">‚ùå</button>
    `;
    container.appendChild(studentDiv);
  });
}

function addStudent() {
  students.push({apellidos:'', nombres:'', notas:Array(cantidadNotas).fill('')});
  rebuildStudentInputs();
  updatePreview();
}

function removeStudent(index){
  students.splice(index,1);
  rebuildStudentInputs();
  updatePreview();
}

function updateStudentGrade(index,actividadIndex,value){
  if(parseFloat(value)>10) value=10;
  students[index].notas[actividadIndex]=value;
  updatePreview();
}

function updatePreview(){
  const institucion=document.getElementById('institucion').value;
  const profesor=document.getElementById('profesor').value;
  const materia=document.getElementById('materia').value;
  const grado=document.getElementById('grado').value;
  const seccion=document.getElementById('seccion').value;
  const fecha=document.getElementById('fecha').value;

  const sortedStudents=[...students].sort((a,b)=>{
    if(a.apellidos.toLowerCase()<b.apellidos.toLowerCase()) return -1;
    if(a.apellidos.toLowerCase()>b.apellidos.toLowerCase()) return 1;
    if(a.nombres.toLowerCase()<b.nombres.toLowerCase()) return -1;
    if(a.nombres.toLowerCase()>b.nombres.toLowerCase()) return 1;
    return 0;
  });

  const tbody=document.querySelector('#preview-table tbody');
  tbody.innerHTML='';
  sortedStudents.forEach(stu=>{
    const validNotas=stu.notas.map(n=>parseFloat(n)||0);
    const suma=validNotas.reduce((a,b)=>a+b,0);
    const promedio=(suma/validNotas.length).toFixed(2);
    const nombreCompleto=`${stu.apellidos}, ${stu.nombres}`;
    const row=document.createElement('tr');
    row.innerHTML=`
      <td>${nombreCompleto}</td>
      ${stu.notas.map(n=>`<td>${n||''}</td>`).join('')}
      <td>${promedio}</td>
    `;
    tbody.appendChild(row);
  });
}

function exportExcel(){
  const table=document.getElementById('preview-table');
  const wb=XLSX.utils.table_to_book(table,{sheet:"Calificaciones"});
  XLSX.writeFile(wb,'Calificaciones.xlsx');
}

function exportPDF(){
  const element=document.getElementById('preview-section');
  html2pdf().from(element).save('Calificaciones.pdf');
}

// Inicializar
updateHeaders();
showSection('calificaciones', document.querySelector('nav a'));
</script>



</body>
</html>
